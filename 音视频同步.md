音视频同步是一个播放器要处理的基本问题，音视频同步的好坏直接影响到播放效果。

解码后的音频片段和视频片段，都分别带有 pts 时间戳信息。回放的时候需要做的，就是尽量保证 apts（音频时间戳）和 vpts（视频之间戳），之间的差值是最小的。为了达到这个目的，就需要在 adev 和 vdev 进行渲染的时候进行控制。控制的方法就是 delay。

由于音频在回放时，我们必须保证连续性，就是说两个**时间上连续的音频片段**是不允许有 delay 的。如果有了 delay 人的耳朵可以很明显的分辨出来，给人的主观感受就是声音卡顿。所以通常情况下，声音都是连续播放，然后在视频渲染的时候做 delay，将视频同步到音频。

在实际情况中，一个多媒体文件可能存在：
1. 只有音频，没有视频（比如 mp3）
1. 只有视频，没有音频（比如 gif）
1. 音频连续，视频连续
1. 音频连续，视频不连续
1. 音频不连续，视频连续
1. 音频不连续，视频不连续

对于第一种情况，我们不用考虑音视频同步，只需要连续播放音频即可。对于第二种情况，我们也不用考虑音视频同步，只需要保证视频回放的帧率稳定即可。对于后面几种情况，我们都需要考虑音视频同步问题。ffplayer 的实现中，对第 1-4 种情况做了处理，可以正确播放只包含音频或只包含视频的多媒体文件，也可以正确播放“音频连续”的多媒体文件。采用的方法就是保证音频连续播放，同时将视频同步到音频。

（待续）
